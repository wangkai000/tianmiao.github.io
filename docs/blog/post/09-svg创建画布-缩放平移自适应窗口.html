<!DOCTYPE html><html lang="en" data-critters-container><head><meta charset="UTF-8"><meta name="author" content="Arvin"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="revisit-after" content="7 days"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><meta name="description" content="SVG创建画布-缩放平移自适应窗口"><meta property="og:title" content="SVG创建画布-缩放平移自适应窗口"><meta property="og:description" content="SVG创建画布-缩放平移自适应窗口"><meta property="og:url" content="https://mmeme.me"><meta property="og:image" content="https://mmeme.me/og%2F09-SVG%E5%88%9B%E5%BB%BA%E7%94%BB%E5%B8%83-%E7%BC%A9%E6%94%BE%E5%B9%B3%E7%A7%BB%E8%87%AA%E9%80%82%E5%BA%94%E7%AA%97%E5%8F%A3.png"><meta property="og:image:username" content="Arvin"><meta property="og:type" content="website"><meta property="og:locale" content="zh_CN"><link rel="icon" href="/logo.svg"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="mask-icon" href="/logo.svg" color="#f3f3f3"><meta name="msapplication-TileColor" content="#f3f3f3"><title>SVG创建画布-缩放平移自适应窗口</title><script>!function(){const e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("vueuse-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script><script type="text/javascript">!function(t,e,n,a,c,r,s){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(r=e.createElement(a)).async=1,r.src="https://www.clarity.ms/tag/l5lha2hb78",(s=e.getElementsByTagName(a)[0]).parentNode.insertBefore(r,s)}(window,document,"clarity","script")</script><script type="module" async crossorigin src="/assets/app-Ddps5ZSK.js"></script><style>@import url(https://gw.alipayobjects.com/os/k/font/lxgwwenkaiscreenr.css);:root{--twoslash-border-color:#8888;--twoslash-underline-color:currentColor;--twoslash-highlighted-border:#c37d0d50;--twoslash-highlighted-bg:#c37d0d20;--twoslash-popup-bg:#f8f8f8;--twoslash-popup-color:inherit;--twoslash-popup-shadow:rgba(0, 0, 0, .08) 0px 1px 4px;--twoslash-docs-color:#888;--twoslash-docs-font:sans-serif;--twoslash-code-font:inherit;--twoslash-code-font-size:1em;--twoslash-matched-color:inherit;--twoslash-unmatched-color:#888;--twoslash-cursor-color:#8888;--twoslash-error-color:#d45656;--twoslash-error-bg:#d4565620;--twoslash-warn-color:#c37d0d;--twoslash-warn-bg:#c37d0d20;--twoslash-tag-color:#3772cf;--twoslash-tag-bg:#3772cf20;--twoslash-tag-warn-color:var(--twoslash-warn-color);--twoslash-tag-warn-bg:var(--twoslash-warn-bg);--twoslash-tag-annotate-color:#1ba673;--twoslash-tag-annotate-bg:#1ba67320}html{--main-text-font-family:X,-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;--background:#ffffff;--bg-color:#ffffff;--text-color:#000000;--bg-main-color:#F3F3F3;--bg-second-color:#e3e3e3;--scrollbar-color:#9C9C9C;--global-text-selection-bg:#30363d;--global-text-selection-text:#ffffff;--input-primary-color:#ffffff;--input-second-color:#ffffff;--card--bg:#F3F3F3;--card-border:#FFFFFF;--card--placeholder-bg:#e3e3e3e0;--header-avatar-bg:#ffffff90;--header-avatar-shadow:0 2px 4px #00000005,0 1px 0 #0000000f;--header-avatar-shadow-1:0 0 0 11px #f2f2f290,0 0 0 24px #fafafa80;--dockbar-bg:#ffffff;--dockbar-placeholder-bg:#ffffff;--dockbar-text:#000000;--nav-bg:#ffffff;--nav-text:#ffffff;--nav-border:2px solid #F3F3F3;--nav-placeholder-bg:#000000;--blog-bg:#ffffff;--blog--border:#ffffff;--blog-text:#ffffff;--blog-card-bg:#F3F3F3;--blog-card-text:#000000;--blog-card-border:#ffffff;--blog-btn:#ffffff;--blog-btn-shadow:#ffffff90;--shadow-block-outer-bg:linear-gradient(145deg, #fefefe, #fff);--shadow-block-inner-bg:linear-gradient(to bottom, #EFEFEF, #ffffff);--shadow-block-content-bg:#C2C2C2;--shadow-block-content-text:#000000;--project-card-bg:#ffffff;--project-card-text:#ffffff;--modal-overlay-bg:#e4e4e7db;--modal-bg:#ffffff;--modal-border:#f3f3f3;--ui-main-bg:#ffffff;--ui-main-text:#000000;--ui-main-border:#0000000a;--ui-button-shadow:inset 0 -3px 4px -1px rgba(0, 0, 0, .04),0 2px 5px rgba(221, 150, 150, .04),0 4px 4px rgba(0, 0, 0, .02),0 0 0 1px rgba(0, 0, 0, .09);--ui-button-hover-shadow:inset 0 -3px 4px -1px rgba(0, 0, 0, .09),0 2px 5px rgba(0, 0, 0, .13),0 4px 4px rgba(0, 0, 0, .02),0 0 0 1px rgba(0, 0, 0, .09);--ui-second-bg:#F3F3F3;--cover-main-color:#1e2982}@tailwind base;@tailwind components;@tailwind utilities;html:not(.dark) .shiki,html:not(.dark) .shiki span{background:var(--s-light-bg);border:1px solid #f3f3f3;color:var(--s-light,inherit);--twoslash-popup-bg:#fafafa}.prose .shiki{font-family:DM Mono,Input Mono,Fira Code,monospace;font-size:.92em;line-height:1.4;margin:.5em 0}.prose img{width:100%}.prose p>img{width:100%;cursor:pointer;margin:2.6em 0;border-radius:.5rem;--tw-shadow:0 1px 3px 0 rgb(0 0 0 / .1),0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.prose{--fg:#555;--fg-deep:#222;--fg-deeper:#000;color:var(--fg)}.prose a{font-weight:inherit;text-decoration:none;border-bottom:1px solid rgba(125,125,125,.3);transition:border .3s ease-in-out}.prose a:hover{border-bottom:1px solid var(--fg)}a.header-anchor{float:left;margin-top:.125em;margin-left:-1.2em;padding-right:.5em;font-size:.85em;opacity:0;text-decoration:none;border:0!important}a.header-anchor:focus,a.header-anchor:hover{text-decoration:none}h3:focus .header-anchor,h3:hover .header-anchor{opacity:.5}.table-of-contents{position:fixed;top:90px;bottom:0;font-size:.8em;left:20px;z-index:200;overflow:hidden;opacity:1!important}@media only screen and (max-width:1080px){.table-of-contents{position:unset;display:flex;flex-direction:column;width:100px}.table-of-contents>ul{opacity:1!important}}.table-of-contents-anchor{margin-left:.5em;margin-right:.5em;width:48px;height:48px;font-size:1.125rem;line-height:1.75rem;display:flex;justify-content:center;align-items:center;border-radius:.25rem;border-width:1px;border-style:solid;--tw-shadow:0 1px 3px 0 rgb(0 0 0 / .1),0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.4s}.table-of-contents>ul{padding-left:0!important;text-overflow:ellipsis;height:100%;overflow-y:auto;border-radius:.25rem;opacity:0;margin-top:4px;padding-bottom:20px;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.7s}:hover>.table-of-contents>.table-of-contents-anchor{color:inherit}:hover>.table-of-contents>ul{opacity:.75}.table-of-contents ul>li:before{display:none}.table-of-contents ul>li{padding-left:.8rem!important;line-height:1.5em;margin-top:.5em}.table-of-contents ul>li>a{opacity:.75;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.table-of-contents ul>li>a :hover{opacity:1}.prose{color:var(--fg);max-width:65ch;font-size:1rem;line-height:1.75}.prose a{color:var(--fg-deeper);text-decoration:none;font-weight:500}.prose ul>li{position:relative;padding-left:1.75em}.prose ul>li:before{content:"";position:absolute;background-color:#d1d5db;border-radius:50%;width:.375em;height:.375em;top:.6875em;left:.25em}.prose h1{color:var(--fg-deeper);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose h3{color:var(--fg-deeper);font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6;opacity:.7}.prose code{color:var(--fg-deep);font-weight:600;font-size:.875em}.prose code:before{content:"`"}.prose code:after{content:"`"}.prose pre{color:#e5e7eb;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding:.8571429em 1.1428571em}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose pre code:before{content:none}.prose pre code:after{content:none}.prose p{margin-top:1.25em;margin-bottom:1.25em}.prose img{margin-top:2em;margin-bottom:2em}.prose ul{margin-top:1.25em;margin-bottom:1.25em;list-style-type:none}.prose li{margin-top:.5em;margin-bottom:.5em}.prose h3+*{margin-top:0}.prose>:first-child{margin-top:0}.prose>:last-child{margin-bottom:0}button:focus-visible{outline:0!important}*,:after,:before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:after,:before{--tw-content:""}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}h1,h3{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}button{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button{text-transform:none}button{-webkit-appearance:button;background-color:transparent;background-image:none}h1,h3,p,pre{margin:0}ul{list-style:none;margin:0;padding:0}button{cursor:pointer}img,svg{display:block;vertical-align:middle}img{max-width:100%;height:auto}:root{--background:0 0% 100%;--foreground:222.2 84% 4.9%;--muted:210 40% 96.1%;--muted-foreground:215.4 16.3% 46.9%;--popover:0 0% 100%;--popover-foreground:222.2 84% 4.9%;--card:0 0% 100%;--card-foreground:222.2 84% 4.9%;--border:214.3 31.8% 91.4%;--input:214.3 31.8% 91.4%;--primary:222.2 47.4% 11.2%;--primary-foreground:210 40% 98%;--secondary:210 40% 96.1%;--secondary-foreground:222.2 47.4% 11.2%;--accent:210 40% 96.1%;--accent-foreground:222.2 47.4% 11.2%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 40% 98%;--ring:222.2 84% 4.9%;--radius:.5rem}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.fixed{position:fixed}.relative{position:relative}.left-0{left:0}.top-0{top:0}.z-\[1\]{z-index:1}.z-\[2\]{z-index:2}.m-auto{margin:auto}.mx-auto{margin-left:auto;margin-right:auto}.mb-0{margin-bottom:0}.mb-8{margin-bottom:2rem}.mb-\[10px\]{margin-bottom:10px}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-\[0px\]{margin-top:0}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-\[16px\]{height:16px}.h-\[40px\]{height:40px}.h-fit{height:-moz-fit-content;height:fit-content}.min-h-screen{min-height:100vh}.w-\[16px\]{width:16px}.w-\[40px\]{width:40px}.w-full{width:100%}.max-w-\[760px\]{max-width:760px}.flex-1{flex:1 1 0%}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.place-items-center{place-items:center}.items-center{align-items:center}.justify-between{justify-content:space-between}.overflow-x-hidden{overflow-x:hidden}.rounded-\[10px\]{border-radius:10px}.bg-\[var\(--bg-main-color\)\]{background-color:var(--bg-main-color)}.bg-transparent{background-color:transparent}.px-2{padding-left:.5rem;padding-right:.5rem}.px-\[10px\]{padding-left:10px;padding-right:10px}.px-\[3\.5vw\]{padding-left:3.5vw;padding-right:3.5vw}.py-4{padding-top:1rem;padding-bottom:1rem}.py-\[18px\]{padding-top:18px;padding-bottom:18px}.pb-20{padding-bottom:5rem}.pt-\[100px\]{padding-top:100px}.pt-\[10px\]{padding-top:10px}.text-right{text-align:right}.text-start{text-align:start}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.opacity-0{opacity:0}.opacity-50{opacity:.5}.\!outline-none{outline:2px solid transparent!important;outline-offset:2px!important}body,html{margin:0;padding:0;min-height:100vh}body:after{content:"";position:fixed;width:100%;height:100%;inset:0;pointer-events:none;z-index:-1;background-image:repeating-linear-gradient(to right,var(--bg-color),var(--bg-color) 1px,transparent 1px,transparent 30px),repeating-linear-gradient(to bottom,var(--bg-color),var(--bg-color) 1px,transparent 1px,transparent 30px)}.table-of-contents{opacity:0}html{background:var(--background);color:var(--text-color)}main{font-family:var(--main-text-font-family);letter-spacing:.6px}@media (min-width:768px){.md\:mt-0{margin-top:0}.md\:h-\[56px\]{height:56px}.md\:h-\[80px\]{height:80px}.md\:w-\[56px\]{width:56px}.md\:flex-row{flex-direction:row}.md\:border{border-width:1px}.md\:border-solid{border-style:solid}.md\:border-\[var\(--blog--border\)\]{border-color:var(--blog--border)}.md\:bg-\[var\(--blog-bg\)\]{background-color:var(--blog-bg)}.md\:p-10{padding:2.5rem}.md\:px-5{padding-left:1.25rem;padding-right:1.25rem}.md\:px-\[36px\]{padding-left:36px;padding-right:36px}.md\:pt-\[112px\]{padding-top:112px}}@media (min-width:1024px){.lg\:inline-block{display:inline-block}}@media print{.print\:hidden{display:none}}#nav-bg[data-v-0216a5e7]{will-change:opacity,transform;backdrop-filter:saturate(50%) blur(8px);-webkit-backdrop-filter:saturate(50%) blur(8px);box-shadow:0 0 transparent,0 0 transparent,var(--header-avatar-shadow);background:linear-gradient(to bottom,var(--background),transparent)}@media (min-width:768px){#nav-bg[data-v-0216a5e7]{height:80px}}#main-root:after{content:"";position:fixed;top:0;left:0;width:100vw;height:100vh;overflow:hidden;background-repeat:no-repeat;pointer-events:none;background-size:cover;background-image:url("data:image/svg+xml,%3Csvg width='842' height='595' viewBox='0 0 842 595' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cg clip-path='url(%23clip0_2_17)'%3E%3Cg opacity='0.4' filter='url(%23filter0_f_2_17)'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M873.139 -138H-32.0396V-99.2928H873.139V-138ZM873.139 84.9079V37.3208L-32.0396 155.833V244.746L873.139 84.9079ZM873.139 129.307V176.894L-32.0396 416.651V327.852L873.139 129.307ZM873.139 268.995V221.408L-32.0396 499.872V588.67L873.139 268.995ZM873.139 361.095V313.508L-32.0396 671.777V684.3H140.89L873.139 361.095ZM873.139 -7.1925V-54.7796L-32.0396 -16.1862V72.7264L873.139 -7.1925ZM873.139 405.608V453.081L436.773 684.3H297.427L873.139 405.608ZM873.139 635.575V497.595L546.975 684.3H794.814L873.139 635.575Z' fill='url(%23paint0_linear_2_17)'/%3E%3C/g%3E%3C/g%3E%3Cdefs%3E%3Cfilter id='filter0_f_2_17' x='-56.0396' y='-162' width='953.179' height='870.3' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'%3E%3CfeFlood flood-opacity='0' result='BackgroundImageFix'/%3E%3CfeBlend mode='normal' in='SourceGraphic' in2='BackgroundImageFix' result='shape'/%3E%3CfeGaussianBlur stdDeviation='12' result='effect1_foregroundBlur_2_17'/%3E%3C/filter%3E%3ClinearGradient id='paint0_linear_2_17' x1='-77.3571' y1='590.972' x2='907.949' y2='590.972' gradientUnits='userSpaceOnUse'%3E%3Cstop stop-opacity='0.13'/%3E%3Cstop offset='1'/%3E%3C/linearGradient%3E%3CclipPath id='clip0_2_17'%3E%3Crect width='842' height='595' fill='white'/%3E%3C/clipPath%3E%3C/defs%3E%3C/svg%3E%0A")}.top-btn[data-v-e3571aee]{position:fixed;bottom:2rem;right:2rem;border-radius:100%;display:grid;place-items:center;cursor:pointer}.top-btn:hover>.back-to-top-btn[data-v-e3571aee]{transform:scale(1.1);background-position:right center;background-size:200% auto}.top-btn:hover>.button-glowing[data-v-e3571aee]{opacity:1}.back-to-top-btn[data-v-e3571aee]{width:40px;height:60px;display:grid;place-items:center;background:var(--blog-btn);border-radius:99999px;transition:all ease-in-out .2s}.button-glowing[data-v-e3571aee]{opacity:0;position:absolute;top:50%;left:50%;width:100px;height:100px;transform:translate(-50%,-50%);transition:all 1s ease;pointer-events:none;z-index:-1;border-radius:9999px;filter:blur(60px);background-image:linear-gradient(45deg,#5021ff,#36e4da,#0047e1)}#blog-root[data-v-a158718a]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(/noise.png);background-repeat:repeat;opacity:.04;z-index:-1;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}</style><link rel="preload" crossorigin href="/assets/app-CDSiGQD4.css" as="style"><link rel="manifest" href="/manifest.webmanifest"><link rel="modulepreload" crossorigin href="/assets/default-YoLfzlCp.js"><link rel="preload" href="/assets/default-DI9AIs5i.css" as="style"><link rel="modulepreload" crossorigin href="/assets/09-SVG创建画布-缩放平移自适应窗口-D4OUaKPF.js"><link rel="modulepreload" crossorigin href="/assets/WrapperPost-CBdctUM8.js"><link rel="preload" href="/assets/WrapperPost-B2FUVXuZ.css" as="style"><meta name="twitter:title" content="SVG创建画布-缩放平移自适应窗口"><meta name="twitter:description" content="SVG创建画布-缩放平移自适应窗口"><meta name="twitter:image" content="https://mmeme.me/og%2F09-SVG%E5%88%9B%E5%BB%BA%E7%94%BB%E5%B8%83-%E7%BC%A9%E6%94%BE%E5%B9%B3%E7%A7%BB%E8%87%AA%E9%80%82%E5%BA%94%E7%AA%97%E5%8F%A3.png"><meta name="twitter:card" content="summary_large_image"><link rel="preload" as="font" crossorigin="anonymous" href="/fonts/DS-DIGIB.TTF"></head><body class="font-sans"><div id="app" data-server-rendered="true"><main id="main-root" class="bg-[var(--bg-main-color)] pt-[100px] pb-20 px-[10px] md:px-5 overflow-x-hidden min-h-screen md:pt-[112px]"><div id="nav-bg" class="fixed left-0 top-0 z-[2] h-fit w-full flex flex-row items-center justify-between px-[3.5vw] py-[18px] md:h-[80px] md:py-unset" style data-v-0216a5e7><img class="mt-[0px] block h-[40px] w-[40px] md:mt-0 md:h-[56px] md:w-[56px]" src="/logo.svg" alt data-v-0216a5e7><!----><div class="grid h-[40px] w-[40px] place-items-center" data-v-0216a5e7><button class="!outline-none" data-v-0216a5e7><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="h-[16px] w-[16px]" style="" width="1em" height="1em" viewBox="0 0 16 16"/></button></div></div><main id="blog-root" style="font-family:LXGW WenKai Screen R" class="relative z-[1] mx-auto max-w-[760px] w-full rounded-[10px] border-unset bg-transparent px-2 pt-[10px] text-start md:border md:border-[var(--blog--border)] md:border-solid md:bg-[var(--blog-bg)] md:p-10 md:px-[36px]" data-v-a158718a><!----><div class="m-auto mb-8 prose" data-v-a158718a><h1 class="slide-enter-50 mb-0" data-v-a158718a>SVG创建画布-缩放平移自适应窗口</h1><p class="slide-enter-50 opacity-50" data-v-a158718a>Jan 8<!----></p><p class="slide-enter-50" style="font-size:80%" data-v-a158718a>SVG创建画布-缩放平移自适应窗口</p><!----><!----><!----></div><article class data-v-a158718a><!--[--><div class="prose m-auto slide-enter-content"><p></p><div class="table-of-contents"><div class="table-of-contents-anchor hidden"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M3 4h18v2H3zm0 7h12v2H3zm0 7h18v2H3z"/></svg></div><ul><li><a href="#鼠标位置-mouse">鼠标位置 mouse</a></li><li><a href="#监听">监听</a></li><li><a href="#平移计算偏移值">平移计算偏移值</a></li><li><a href="#缩放计算偏移值">缩放计算偏移值</a></li><li><a href="#监听窗口改变后的画布">监听窗口改变后的画布</a></li></ul></div><p></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f8a6bf6c03e4cd5875ad78af4db681c~tplv-k3u1fbpfcp-watermark.image?" alt="canvas.gif"></p><p>在线源码及预览地址：<a href="https://stackblitz.com/edit/vitejs-vite-q5jcer?file=README.md" target="_blank" rel="noopener">https://stackblitz.com/edit/vitejs-vite-q5jcer?file=README.md</a></p><p>主要构思就是一个SVG。新建对象都在这个SVG中，鼠标移动绘制Path。</p><p>这里主要讨论一下，平移缩放画布后的位置计算。</p><p>初始化，画布尺寸 <code>[100vw,100vh]</code></p><h3 id="鼠标位置-mouse" tabindex="-1">鼠标位置 mouse <a class="header-anchor" href="#鼠标位置-mouse" aria-hidden="true">#</a></h3><p>这里参考了 <a href="https://juejin.cn/post/6883353218319908871" target="_blank" rel="noopener">https://juejin.cn/post/6883353218319908871</a></p><ul><li>MouseEvent.clientX 是只读属性， 它提供事件发生时的应用客户端区域的水平坐标 (与页面坐标不同)。例如，不论页面是否有水平滚动，当你点击客户端区域的左上角时，鼠标事件的 clientX 值都将为 0 。</li><li>MouseEvent.clientY 是只读属性， 它提供事件发生时的应用客户端区域的垂直坐标 (与页面坐标不同)。例如，当你点击客户端区域的左上角时，鼠标事件的 clientY 值为 0 ，这一值与页面是否有垂直滚动无关。</li><li>MouseEvent.movementX 是只读属性，它提供了当前事件和上一个mousemove事件之间鼠标在水平方向上的移动值。换句话说，这个值是这样计算的 : currentEvent.movementX = currentEvent.screenX - previousEvent.screenX.</li><li>MouseEvent.movementY 是只读属性，它提供了当前事件和上一个 mousemove 事件之间鼠标在水平方向上的移动值。换句话说，这个值是这样计算的 :currentEvent.movementY = currentEvent.screenY - previousEvent.screenY.</li><li>MouseEvent.offsetX规定了事件对象与目标节点的内填充边（padding edge）在 X 轴方向上的偏移量。</li><li>MouseEvent.offsetY规定了事件对象与目标节点的内填充边（padding edge）在 Y 轴方向上的偏移量。</li><li>MouseEvent.pageX 是一个由MouseEvent接口返回的相对于整个文档的x（水平）坐标以像素为单位的只读属性。这个属性将基于文档的边缘，考虑任何页面的水平方向上的滚动。举个例子，如果页面向右滚动 200px 并出现了滚动条，这部分在窗口之外，然后鼠标点击距离窗口左边 100px 的位置，pageX 所返回的值将是 300。</li><li>MouseEvent.pageY是一个只读属性，它返回触发事件的位置相对于整个 document 的 Y 坐标值。由于其参考物是整个 dom，所以这个值受页面垂直方向的滚动影响。例如：当你垂直方向向下滚动了 50 pixel，那么你在顶端进行点击的时候，获取的pageY为 50pixed 而不是 0。</li><li>MouseEvent.screenX是只读属性，他提供了鼠标相对于屏幕坐标系的水平偏移量。</li><li>MouseEvent.screenY是只读属性，它提供了鼠标相对于屏幕坐标系的垂直偏移量。</li><li>MouseEvent.x 是 MouseEvent.clientX 属性的别名.</li><li>MouseEvent.y 属性是 MouseEvent.clientY 属性的别称。</li></ul><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e8e6fc9300d475490a3f62c8c4870b1~tplv-k3u1fbpfcp-watermark.image?" alt="offset.png"></p><h3 id="监听" tabindex="-1">监听 <a class="header-anchor" href="#监听" aria-hidden="true">#</a></h3><p>这里监听的是 <code>onpointerdown onpointermove onpointerup</code> 代替鼠标的 <code>mouse-</code>事件，获取 <code>pressure</code> 值。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerDown</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">target</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">setPointerCapture</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pointerId)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [[pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pressure]]</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerUp</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  draggedEvt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerMove</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (isPressedCtrl</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">{</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">    // 移动画布</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">    drag</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  else</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">buttons </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">      return</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [</span><span style="--s-dark:#F97583;--s-light:#179299">...</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pressure]]</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>上面三个方法，按下ctrl键再移动，就是拖拽画布，否则就是将这些点位添加到数组中，用来构造 <code>path</code>。 当然，每个点需要经过 <code>eventToLocation</code> 方法计算过滤后再添加。 当画布没有拖拽移动的时候，其实经过处理后的坐标没变。拖拽之后，就会在鼠标的位置上添加偏移值。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">// 拖拽方法</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">let</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> draggedEvt</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> any</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic"> // 每次的拖拽事件</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> drag</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">event</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> TouchEvent</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(event)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (draggedEvt) </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">{</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> oriPt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(draggedEvt)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oriPt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oriPt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">    updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  draggedEvt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>这里其实只是修改 <code>viewBox</code> 起点（前两个值）就可以满足拖拽视图。 首先计算出两次拖拽偏移的差值（鼠标两次值），然后再跟原来的相加就行。</p><h3 id="平移计算偏移值" tabindex="-1">平移计算偏移值 <a class="header-anchor" href="#平移计算偏移值" aria-hidden="true">#</a></h3><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">event</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> TouchEvent</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> idx</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> touch</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#8839EF">instanceof</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> ?</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">touches[idx]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientX </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientY </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  return</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>这里使用了<code>@vueuse</code>的<code>useElementBounding</code>方法获取当前dom距离浏览器的距离。这个方法使用的是 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noopener">Element.getBoundingClientRect()</a></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01b9390c0eea43638a1c2d0e3141a6ff~tplv-k3u1fbpfcp-watermark.image?" alt="images20221116144009.png"></p><p>这里使用的<code>clientX clientY</code>，因为画布是占满浏览器的，所以这里<code>pageX(Y) clientX(Y) offsetX(Y)</code>值是相同的。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> w</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> h</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> force</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> false</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (w </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    w </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (h </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    h </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">w </span><span style="--s-dark:#F97583;--s-light:#179299">||</span><span style="--s-dark:#F97583;--s-light:#179299"> !</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">h)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>这里其实应该主要是赋值给 <code>cfg</code> ，然后更新视图。前面几个if判断，主要是为了保证画布的长宽比例要跟外面的盒子的长宽比一致。</p><h3 id="缩放计算偏移值" tabindex="-1">缩放计算偏移值 <a class="header-anchor" href="#缩放计算偏移值" aria-hidden="true">#</a></h3><p>经过上面的平移计算，主要得出几点</p><ul><li>通过调整 <code>viewBox</code> 更改视图</li><li>每个点需要经过 <code>eventToLocation</code> 计算</li><li>平移的点的偏移量主要是计算赋值给 <code>viewBox</code> 的前两个值，就是用上一个点的位置 + （这个位置和上个位置的差）</li></ul><p>那么放大缩小其实也是一样，</p><ul><li>通过调整 <code>viewBox</code> 更改视图</li><li>每个点需要经过 <code>eventToLocation</code> 计算</li><li>缩放需要计算四个值</li></ul><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handleWheel</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">preventDefault</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">()</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> scale</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 1.005</span><span style="--s-dark:#F97583;--s-light:#179299"> **</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">deltaY</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  zoomViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(scale</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> zoomViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">scale</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> pt</span><span style="--s-dark:#F97583;--s-light:#179299">?:</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69;--s-dark-font-style:inherit;--s-light-font-style:italic"> x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69;--s-dark-font-style:inherit;--s-light-font-style:italic"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> })</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pt)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    pt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> ((pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX) </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX))</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> ((pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY) </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY))</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>监听鼠标滚轮，然后计算当前的鼠标点的位置转成平面坐标。 <code>zoomViewPort</code> 计算四个值，然后调用 <code>updateViewPort</code> 赋值给 <code>viewBox</code></p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">event</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> TouchEvent</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> idx</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> touch</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#8839EF">instanceof</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> ?</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">touches[idx]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientX </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientY </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  return</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><p>这里 <code>eventToLocation()</code> 方法需要改变了，因为是缩放，之前平移的时候，只是相加减差值，这需要乘上缩放的值（默认为1）</p><p>然后 <code>updateViewPort()</code> 方法也需要改一下，之前只是设置了视图 <code>viewBox</code> 的值，现在多加一句设置zoom缩放的层级。 层级通过画布跟盒子的比例得出，长或者宽都行，这里使用的画布的宽和盒子的宽得出的比例。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> w</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> h</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> force</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> false</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (w </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    w </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (h </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    h </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">w </span><span style="--s-dark:#F97583;--s-light:#179299">||</span><span style="--s-dark:#F97583;--s-light:#179299"> !</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">h)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 设置zoom层级</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre><h3 id="监听窗口改变后的画布" tabindex="-1">监听窗口改变后的画布 <a class="header-anchor" href="#监听窗口改变后的画布" aria-hidden="true">#</a></h3><p>做完上面的事情之后,会发现有的时候窗口大小修改,但是画布并没有做处理,这样使得再次绘制的时候,鼠标的位置计算有偏差。 这里进行的处理很简单，跟上步平移的操作类似，重新设置一下窗口的 <code>viewBox</code> 的后两个值。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> height</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">watch</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">([width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> height]</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> (</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">newValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> oldValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 过滤一下第一次。因为监听的是dom的长宽，第一次肯定会触发，长宽从0到设置的值。</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 这个时候的差值就是dom元素本身，而不是窗口偏移的值，所以这个时候跳出方法</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceX</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceY</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceY</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span></code></pre><p>这里就只需监听窗口的长宽，然后计算差值，赋值给宽高就行了。 第一步的时候，因为dom元素会从0到设置的尺寸，也就是默认这个会走一次，这个时候的差值其实是尺寸本身，如果再设置<code>viewBox</code>的话，相当于重复多设置了长宽，这个时候跳出，避免这个问题。</p><p>初步测试没什么问题，但是如果先缩放，再改变画布尺寸大小，这样就会出现问题了。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceX</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceY</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceY</span></span></code></pre><p>在没有经过缩放的时候，<code>viewPortWidth</code> 和 <code>viewPortHeight</code> 都是跟画布尺寸 1:1 的，这样的差值<code>distanceX distanceY</code>计算也是没问题。 但是缩放之后，<code>viewPortWidth</code> 和 <code>viewPortHeight</code> 是经过 <code>viewPortZoom</code> 处理的。 如果只是上面的这样1:1的平移计算，经过缩放后，就会出现问题。只是改变窗口尺寸大小，画布尺寸就会被缩放。如果缩小的过多， w 和 h 为负值，赋值给 <code>viewBox</code> 报错。</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> height</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">watch</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">([width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> height]</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> (</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">newValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> oldValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceX</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceY</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceY</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span></code></pre><p>跟以上步骤的处理方法一致，计算差值的时候乘以缩放值。</p><p>全部代码如下:</p><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-vue"><span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">script</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> setup</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> lang</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"ts"</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">import</span><span style="--s-dark:#F97583;--s-light:#8839EF"> type</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> StrokeOptions </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#F97583;--s-light:#8839EF"> from</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B"> 'perfect-freehand'</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">import</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> getStroke </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#F97583;--s-light:#8839EF"> from</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B"> 'perfect-freehand'</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">import</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> getSvgPathFromStroke </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#F97583;--s-light:#8839EF"> from</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B"> '../../utils/index'</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> options</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> StrokeOptions</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  size</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 10</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  thinning</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.618</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  smoothing</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  streamline</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> points</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> ref</span><span style="--s-dark:#F97583;--s-light:#179299">&lt;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(number[] </span><span style="--s-dark:#F97583;--s-light:#179299">|</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  x</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> number</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  y: number</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  pressure</span><span style="--s-dark:#F97583;--s-light:#179299">?:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> number</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)[]</span><span style="--s-dark:#F97583;--s-light:#179299">&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">([])</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pathData</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">''</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">watch</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">()</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> ()</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> stroke</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> getStroke</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> options)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  pathData</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> getSvgPathFromStroke</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(stroke)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> Ctrl</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useMagicKeys</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">()</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> isPressedCtrl</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">false</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">watch</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(Ctrl</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> (</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">v</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  isPressedCtrl</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> v</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#04A5E5">&lt;</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic">HTMLElement</span><span style="--s-dark:#E1E4E8;--s-light:#04A5E5">&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">()</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">{</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortX</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortY</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortWidth</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortHeight</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> setViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">()</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">onMounted</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">()</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  setViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">()</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">let</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> draggedEvt</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> any</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic"> // 每次的拖拽事件</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> drag</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">event</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> TouchEvent</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(event)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (draggedEvt) </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">{</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> oriPt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(draggedEvt)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oriPt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oriPt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">    updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  draggedEvt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">event</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> TouchEvent</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> idx</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> touch</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#8839EF">instanceof</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D;--s-dark-font-style:inherit;--s-light-font-style:italic"> MouseEvent</span><span style="--s-dark:#F97583;--s-light:#179299"> ?</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event </span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> event</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">touches[idx]</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientX </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> left</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (touch</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">clientY </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> top</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  return</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> w</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> h</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#F97583;--s-light:#179299"> |</span><span style="--s-dark:#79B8FF;--s-light:#8839EF;--s-dark-font-style:inherit;--s-light-font-style:italic"> null</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> force</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> false</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 这里的w,h比例应该跟画布的比例相同。虽然在调用这个方法之前计算的w、h也是根据比例计算的。</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 这里经过下面的计算不出意外得出的值应该跟其之前相同</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (w </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    w </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (h </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    h </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetHeight </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">w </span><span style="--s-dark:#F97583;--s-light:#179299">||</span><span style="--s-dark:#F97583;--s-light:#179299"> !</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">h)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">6</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> Number</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">parseFloat</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">((</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">toPrecision</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">4</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">))</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> svgWrapperRef</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">offsetWidth</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerDown</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">target</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">setPointerCapture</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pointerId)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [[pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pressure]]</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerMove</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (isPressedCtrl</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value) </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">{</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">    // 移动画布</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">    drag</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  else</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">buttons </span><span style="--s-dark:#F97583;--s-light:#179299">!==</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">      return</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [</span><span style="--s-dark:#F97583;--s-light:#179299">...</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">points</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> [pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pressure]]</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">  }</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handlePointerUp</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  draggedEvt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> null</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> handleWheel</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">e</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">preventDefault</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">()</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> scale</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 1.005</span><span style="--s-dark:#F97583;--s-light:#179299"> **</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> e</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">deltaY</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> pt</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> eventToLocation</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(e)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  zoomViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(scale</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> pt)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> zoomViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">scale</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> pt</span><span style="--s-dark:#F97583;--s-light:#179299">?:</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69;--s-dark-font-style:inherit;--s-light-font-style:italic"> x</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#4C4F69;--s-dark-font-style:inherit;--s-light-font-style:italic"> y</span><span style="--s-dark:#F97583;--s-light:#179299">:</span><span style="--s-dark:#79B8FF;--s-light:#8839EF"> number</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> })</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pt)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    pt </span><span style="--s-dark:#F97583;--s-light:#179299">=</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#179299">:</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0.5</span><span style="--s-dark:#F97583;--s-light:#179299"> *</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> ((pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX) </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">x </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX))</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> ((pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY) </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (pt</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">y </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY))</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> scale </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> height</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> }</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> useElementBounding</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(svgWrapperRef)</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">watch</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">([width</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> height]</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> (</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">newValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> oldValue</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 过滤一下第一次。因为监听的是dom的长宽，第一次肯定会触发，长宽从0到设置的值。</span></span>
<span class="line"><span style="--s-dark:#6A737D;--s-light:#9CA0B0;--s-dark-font-style:inherit;--s-light-font-style:italic">  // 这个时候的差值就是dom元素本身，而不是窗口偏移的值，所以这个时候跳出方法</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#F97583;--s-light:#179299"> &amp;&amp;</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">===</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceX</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> distanceY</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (newValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">] </span><span style="--s-dark:#F97583;--s-light:#179299">-</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> oldValue[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]) </span><span style="--s-dark:#F97583;--s-light:#179299">*</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> viewPortZoom</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> x</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> w</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceX</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> h</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> cfg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">value</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> distanceY</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">  updateViewPort</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> w</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> h)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;/</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">script</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">template</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">  &lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">div</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> id</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"svgWrapperRef"</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> ref</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"svgWrapperRef"</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> class</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"h-screen w-screen overflow-hidden rounded-md"</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">    &lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">svg</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#DF8E1D">      id</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"svgCanvasRef"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">      :</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">viewBox</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"`</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93">${</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">cfg</span><span style="--s-dark:#9ECBFF;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortX</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93">}</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93"> ${</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">cfg</span><span style="--s-dark:#9ECBFF;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortY</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93">}</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93"> ${</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">cfg</span><span style="--s-dark:#9ECBFF;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortWidth</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93">}</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93"> ${</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">cfg</span><span style="--s-dark:#9ECBFF;--s-light:#179299">.</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">viewPortHeight</span><span style="--s-dark:#9ECBFF;--s-light:#7C7F93">}</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">`"</span></span>
<span class="line"><span style="--s-dark:#B392F0;--s-light:#DF8E1D">      class</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"h-full w-full"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">      @</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">pointerdown</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">handlePointerDown</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">      @</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">pointermove</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">handlePointerMove</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">      @</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">pointerup</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">handlePointerUp</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">      @</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">wheel</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">handleWheel</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">    &gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">      &lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">path</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> :</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D">d</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">pathData</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"</span><span style="--s-dark:#E1E4E8;--s-light:#179299"> /&gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">    &lt;/</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">svg</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">  &lt;/</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">div</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;/</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">template</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">style</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> lang</span><span style="--s-dark:#E1E4E8;--s-light:#179299">=</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">"less"</span><span style="--s-dark:#B392F0;--s-light:#DF8E1D"> scoped</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#179299">&lt;/</span><span style="--s-dark:#85E89D;--s-light:#1E66F5">style</span><span style="--s-dark:#E1E4E8;--s-light:#179299">&gt;</span></span></code></pre><pre class="shiki shiki-themes github-dark catppuccin-latte" style="--s-dark:#e1e4e8;--s-light:#4c4f69;--s-dark-bg:#24292e;--s-light-bg:#eff1f5" tabindex="0"><code class="language-ts"><span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">export</span><span style="--s-dark:#F97583;--s-light:#8839EF"> function</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic"> getSvgPathFromStroke</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">(</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">stroke</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  if</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (</span><span style="--s-dark:#F97583;--s-light:#179299">!</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">stroke</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69">length</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">    return</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B"> ''</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  const</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> d</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> stroke</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">reduce</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">    (</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">acc</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> [</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic">x0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> y0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">],</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> i</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#FFAB70;--s-light:#E64553;--s-dark-font-style:inherit;--s-light-font-style:italic"> arr</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">)</span><span style="--s-dark:#F97583;--s-light:#179299"> =&gt;</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> {</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">      const</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93"> [</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69">x1</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69"> y1</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">]</span><span style="--s-dark:#F97583;--s-light:#179299"> =</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> arr[(i </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 1</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">) </span><span style="--s-dark:#F97583;--s-light:#179299">%</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> arr</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#79B8FF;--s-light:#4C4F69">length</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">      acc</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">push</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(x0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y0</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (x0 </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> x1) </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 2</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> (y0 </span><span style="--s-dark:#F97583;--s-light:#179299">+</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> y1) </span><span style="--s-dark:#F97583;--s-light:#179299">/</span><span style="--s-dark:#79B8FF;--s-light:#FE640B"> 2</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">      return</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> acc</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">    },</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">    [</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">'M'</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#F97583;--s-light:#179299"> ...</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">stroke[</span><span style="--s-dark:#79B8FF;--s-light:#FE640B">0</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B"> 'Q'</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">]</span><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">,</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">  d</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">push</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">'Z'</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#F97583;--s-light:#8839EF">  return</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69"> d</span><span style="--s-dark:#E1E4E8;--s-light:#179299">.</span><span style="--s-dark:#B392F0;--s-light:#1E66F5;--s-dark-font-style:inherit;--s-light-font-style:italic">join</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">(</span><span style="--s-dark:#9ECBFF;--s-light:#40A02B">' '</span><span style="--s-dark:#E1E4E8;--s-light:#4C4F69">)</span></span>
<span class="line"><span style="--s-dark:#E1E4E8;--s-light:#7C7F93">}</span></span></code></pre></div><!--]--></article><div class="slide-enter m-auto mt-8 animate-delay-500 prose print:hidden" data-v-a158718a><div class="mb-[10px] flex flex-col items-center justify-between font-mono op50 md:flex-row hover:op75" data-v-a158718a><div class="flex-1" data-v-a158718a>发布日期: 2024/01/08</div><div class="mt-4 flex-1 text-right md:mt-0" data-v-a158718a><a href="https://github.com/" title="Star" target="_blank" class="hidden lg:inline-block" data-v-a158718a>Github</a></div></div></div><div class="slide-enter m-auto mb-8 animate-delay-500 prose print:hidden" data-v-a158718a><br data-v-a158718a><span font-mono op50 data-v-a158718a>&gt; </span><a href="/blog" class="font-mono op50 hover:op75" data-v-a158718a>cd ..</a><div class="py-4" data-v-a158718a></div><div data-v-a158718a></div></div><div class="top-btn opacity-0" data-v-a158718a data-v-e3571aee><div class="back-to-top-btn" data-v-e3571aee><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32" data-v-e3571aee=""><g fill="none" data-v-e3571aee=""><g filter="url(#f2377id0)" data-v-e3571aee=""><path fill="url(#f2377id2)" d="m7.545 10.19l7.57-8.13a.992.992 0 0 1 1.43-.01l7.57 8.13c.56.597.12 1.564-.71 1.564h-3.64c-.35 0-.64.284-.64.626v5.194c0 .645-.53 1.163-1.19 1.163h-4.22c-.65 0-1.19-.518-1.18-1.153v-5.195a.637.637 0 0 0-.64-.625h-3.64c-.83 0-1.27-.958-.71-1.563" data-v-e3571aee=""/></g><g fill="#59555F" filter="url(#f2377id1)" data-v-e3571aee=""><path d="M12.27 20.569H5.83c-.55 0-1 .45-1 1s.45 1 1 1h2.22v6.17c0 .55.45 1 1 1s1-.45 1-1v-6.17h2.22c.55 0 1-.45 1-1c0-.56-.45-1-1-1m9.39.01h2.77c1.51 0 2.74 1.23 2.74 2.74c0 1.51-1.23 2.74-2.74 2.74h-1.77v2.69c0 .55-.45 1-1 1s-1-.45-1-1v-7.17c0-.55.45-1 1-1m1 3.48h1.77c.41 0 .74-.33.74-.74s-.33-.74-.74-.74h-1.77zm-9.39 2.55c0 1.73 1.41 3.14 3.15 3.14c1.73 0 3.15-1.41 3.15-3.14v-2.88c0-1.73-1.41-3.14-3.15-3.14s-3.15 1.41-3.15 3.14zm2-2.88a1.15 1.15 0 0 1 2.3 0v2.88c0 .64-.52 1.15-1.15 1.15c-.63 0-1.15-.52-1.15-1.15z" data-v-e3571aee=""/></g><defs data-v-e3571aee=""><filter id="f2377id0" width="18.571" height="18.976" x="6.794" y=".751" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" data-v-e3571aee=""><feFlood flood-opacity="0" result="BackgroundImageFix" data-v-e3571aee=""/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dx="-.5" dy=".5" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".375" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.505882 0 0 0 0 0.47451 0 0 0 0 0.537255 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="shape" result="effect1_innerShadow_18590_958" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dy="-1" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".5" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.152941 0 0 0 0 0.12549 0 0 0 0 0.188235 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="effect1_innerShadow_18590_958" result="effect2_innerShadow_18590_958" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dx="1" dy="-1" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".5" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.152941 0 0 0 0 0.12549 0 0 0 0 0.188235 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="effect2_innerShadow_18590_958" result="effect3_innerShadow_18590_958" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dx="1" dy="1" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".5" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.239216 0 0 0 0 0.192157 0 0 0 0 0.290196 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="effect3_innerShadow_18590_958" result="effect4_innerShadow_18590_958" data-v-e3571aee=""/></filter><filter id="f2377id1" width="23.19" height="9.83" x="4.63" y="19.919" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" data-v-e3571aee=""><feFlood flood-opacity="0" result="BackgroundImageFix" data-v-e3571aee=""/><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dy="-.65" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".325" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.176471 0 0 0 0 0.141176 0 0 0 0 0.211765 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="shape" result="effect1_innerShadow_18590_958" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dx=".65" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".325" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.176471 0 0 0 0 0.141176 0 0 0 0 0.211765 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="effect1_innerShadow_18590_958" result="effect2_innerShadow_18590_958" data-v-e3571aee=""/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" data-v-e3571aee=""/><feOffset dx="-.2" data-v-e3571aee=""/><feGaussianBlur stdDeviation=".25" data-v-e3571aee=""/><feComposite in2="hardAlpha" k2="-1" k3="1" operator="arithmetic" data-v-e3571aee=""/><feColorMatrix values="0 0 0 0 0.176471 0 0 0 0 0.141176 0 0 0 0 0.211765 0 0 0 1 0" data-v-e3571aee=""/><feBlend in2="effect2_innerShadow_18590_958" result="effect3_innerShadow_18590_958" data-v-e3571aee=""/></filter><linearGradient id="f2377id2" x1="15.83" x2="15.83" y1="5.028" y2="18.727" gradientUnits="userSpaceOnUse" data-v-e3571aee=""><stop stop-color="#61576D" data-v-e3571aee=""/><stop offset="1" stop-color="#4D4753" data-v-e3571aee=""/></linearGradient></defs></g></svg></div><div class="button-glowing" data-v-e3571aee></div></div></main><!----><!----></main></div><script>window.__INITIAL_STATE__='{"pinia":{}}'</script><noscript>This website requires JavaScript to function properly. Please enable JavaScript to continue.</noscript><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><link rel="stylesheet" href="/assets/default-DI9AIs5i.css"><link rel="stylesheet" href="/assets/WrapperPost-B2FUVXuZ.css"><link rel="stylesheet" href="/assets/app-CDSiGQD4.css"></body></html>